#people, 100 was chosen. This was because the weights of the words were similar and the logic
#explained for old people was applicable with the threshold of 100.
### Part b
emnlp14age %>%
filter(weight < 0) %>%
mutate(weight = abs(weight)**2) %>%
arrange(desc(weight)) %>%
top_n(200)  %>%
wordcloud2(size=0.3)
library(geojsonio)
#downloaded from https://catalog.data.gov/dataset?res_format=GeoJSON
bike_crashes <- geojson_read("bicycle-crash-data-chapel-hill-region.geojson",
what="sp")
library(geojsonio)
install.packages("geojsonio")
installed.packages("geojsonio")
library(geojsonio)
install.packages("e1071")
library(geojsonio)
library(e1071)
install.packages("e1071")
(geojsonio)
library(geojsonio)
install.packages("e1071", force=TRUE)
url <- 'https://opendata.arcgis.com/datasets/744c03a8165a42929f37e2c9f58dc860_0.geojson'
districts <- geojson_read(url, what="sp")
library(geojsonio)
install.packages('e1071', dependencies=TRUE)
library(geojsonio)
museum %>%
mutate(rev = (Revenue)**2) %>%
mutate(inc = (Income)**2) %>%
group_by(Type) %>%
ggplot(aes(inc, rev, fill=Type, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue")
museum %>%
mutate(rev = (Revenue)**2) %>%
mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(inc, rev, fill=Type, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue")
museum %>%
mutate(rev = (Revenue)**2) %>%
mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(inc, rev, fill=Type, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue")
setwd("/Users/maxryoo/Documents/Spring 2019/STAT4310/seattle")
reviews <- read_csv("reviews.csv")
reviews
listing <- read_csv("listing.csv")
listing
setwd("/Users/maxryoo/Documents/Spring 2019/STAT4310/seattle")
listing <- read_csv("listings.csv")
listing
listing
calendar <- read_csv("calendar.csv")
calendar
#young people
emnlp14age %>%
filter(weight < 0) %>%
mutate(weight = abs(weight)) %>%
arrange(desc(weight)) %>%
top_n(100)  %>%
wordcloud2(size=0.2)
#old people
emnlp14age %>%
filter(weight >0) %>%
arrange(desc(weight)) %>%
top_n(150) %>%
wordcloud2(size=0.4)
#young people
emnlp14age %>%
filter(weight < 0) %>%
mutate(weight = abs(weight)) %>%
arrange(desc(weight)) %>%
top_n(100)  %>%
wordcloud2(size=0.2)
listings <- read_csv("listings.csv")
listings
list(listings)
listings$longitude
listings$longitude
leaflet(data=listings) %>% addTiles() %>%
addMarkers(lng=~longitude, lat=~latitude)
library(leaflet)
leaflet(data=listings) %>% addTiles() %>%
addMarkers(lng=~longitude, lat=~latitude)
leaflet(data=listings) %>% head(50) %>% addTiles() %>%
addMarkers(lng=~longitude, lat=~latitude)
leaflet(data=listings) %>% head(50) %>% addTiles() %>%
addMarkers(lng=~longitude, lat=~latitude)
listings %>%
head(50) %>%
leaflet() %>%
addTiles() %>%
addMarkers(lng=~longitude, lat=~latitude)
listings %>%
head(50) %>%
leaflet() %>%
addTiles() %>%
addMarkers(lng=~longitude, lat=~latitude)
listings %>%
head(50) %>%
leaflet() %>%
addTiles() %>%
addMarkers(lng=~longitude, lat=~latitude)
listings %>%
head(50) %>%
leaflet() %>%
addTiles() %>%
addMarkers(lng=~longitude, lat=~latitude)
listings %>%
head(50) %>%
leaflet() %>%
addTiles() %>%
addMarkers(lng=~longitude, lat=~latitude)
setwd("/Users/maxryoo/Documents/Spring 2019/STAT4310/seattle")
listings <- read_csv("listings.csv")
listings$longitude
listings$longitude
listings$longitude
listings$longitude
listings %>%
head(50) %>%
leaflet() %>%
addTiles() %>%
addMarkers(lng=~longitude, lat=~latitude)
museum %>%
group_by(State) %>%
filter(Revenue > 0) %>%
summarize(avg = log2(mean(Revenue)))%>%
inner_join(us_data, by=c("State"="region")) %>%
ggplot(aes(long,lat,group=group,fill=avg)) +
geom_polygon(color="black") +
scale_fill_gradient(low="red",
high="yellow",
limit = c(15,30),
breaks = c(0,20,22.5,25,27.5)) +
theme_bw() +
theme(panel.background = element_rect(fill = 'BLACK')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
labs(title="Average Revenue by State")
museum %>%
mutate(rev = (Revenue)**2) %>%
mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(inc, rev, fill=Type, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue")
### Part c
museum %>%
mutate(rev = (Revenue)**2) %>%
mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(inc, rev, fill=Type, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue")
### Part c
museum %>%
#mutate(rev = (Revenue)**2) %>%
#mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(inc, rev, fill=Type, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue")
### Part c
museum %>%
#mutate(rev = (Revenue)**2) %>%
#mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(Income, Revenue, fill=Type, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue")
### Part c
museum %>%
#mutate(rev = (Revenue)**2) %>%
#mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
unique(Type)
### Part c
museum %>%
#mutate(rev = (Revenue)**2) %>%
#mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(Income, Revenue, fill=Type, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue")
### Part b
emnlp14age %>%
filter(weight < 0) %>%
mutate(weight = abs(weight)**2) %>%
arrange(desc(weight)) %>%
top_n(200)  %>%
wordcloud2(size=0.3)
### Part c
museum %>%
#mutate(rev = (Revenue)**2) %>%
#mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(Income, Revenue, fill=Type, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue")
### Part c
museum %>%
#mutate(rev = (Revenue)**2) %>%
#mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(Income, Revenue, fill=Type, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue") +
labs=(legend = "Types of Museums")
### Part c
museum %>%
#mutate(rev = (Revenue)**2) %>%
#mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(Income, Revenue, fill=Type, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue") +
labs=(color = "Types of Museums")
### Part c
museum %>%
#mutate(rev = (Revenue)**2) %>%
#mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(Income, Revenue, fill=Type, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue") +
labs(color = "Types of Museums")
### Part c
museum %>%
#mutate(rev = (Revenue)**2) %>%
#mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(Income, Revenue, fill=Type, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue") +
labs(fill = "Types of Museums")
### Part c
museum %>%
#mutate(rev = (Revenue)**2) %>%
#mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(Income, Revenue, fill=Type, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue") +
labs(fill,color = "Types of Museums")
### Part c
museum %>%
#mutate(rev = (Revenue)**2) %>%
#mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(Income, Revenue, fill=Type, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue")
### Part c
museum %>%
#mutate(rev = (Revenue)**2) %>%
#mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(Income, Revenue, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue") +
## Problme 3
### Part a
library(wordcloud2)
### Part c
museum %>%
#mutate(rev = (Revenue)**2) %>%
#mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(Income, Revenue, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue") +
## Problme 3
### Part a
library(wordcloud2)
### Part c
museum %>%
#mutate(rev = (Revenue)**2) %>%
#mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(Income, Revenue, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue")
### Part c
museum %>%
#mutate(rev = (Revenue)**2) %>%
#mutate(inc = (Income)**2) %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(Income, Revenue, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue") +
labs(color="Types of Mesuems")
#young people
emnlp14age %>%
filter(weight < 0) %>%
mutate(weight = abs(weight)) %>%
arrange(desc(weight)) %>%
top_n(100)  %>%
wordcloud2(size=0.2)
#young people
emnlp14age %>%
filter(weight < 0) %>%
mutate(weight = abs(weight)) %>%
arrange(desc(weight)) %>%
top_n(150)  %>%
wordcloud2(size=0.2)
#young people
emnlp14age %>%
filter(weight < 0) %>%
mutate(weight = abs(weight)) %>%
arrange(desc(weight)) %>%
top_n(100)  %>%
wordcloud2(size=0.2)
#old people
emnlp14age %>%
filter(weight >0) %>%
arrange(desc(weight)) %>%
top_n(150) %>%
wordcloud2(size=0.4)
museum %>%
na.omit() %>%
filter(State != "alaska") %>%
filter(State != "hawaii") %>%
filter(Longitude > (-150)) %>%
filter(Latitude < 60) %>%
filter(Revenue > 0) %>%
ggplot() +
geom_point(aes(x=Longitude, y=Latitude, color= Revenue)) +
scale_colour_gradient(low="red",
high="yellow",
limit = c(1,1e+9),
breaks = c(0,1e+3,1e+6,1e+9),
trans="log2") +
theme_bw() +
theme(panel.background = element_rect(fill = 'BLACK')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
### Part c
museum %>%
group_by(Type) %>%
arrange(Revenue) %>%
ggplot(aes(Income, Revenue, color=Type)) + geom_smooth(method=lm, se=F) +
theme_bw() +
xlab("Income") +
ylab("Revenue") +
labs(color="Types of Mesuems")
museum %>%
na.omit() %>%
filter(State != "alaska") %>%
filter(State != "hawaii") %>%
filter(Longitude > (-150)) %>%
filter(Latitude < 60) %>%
filter(Revenue > 0) %>%
ggplot() +
geom_point(aes(x=Longitude, y=Latitude, color= Revenue)) +
scale_colour_gradient(low="red",
high="yellow",
limit = c(1,1e+9),
breaks = c(0,1e+3,1e+6,1e+9),
trans="log2") +
theme_bw() +
theme(panel.background = element_rect(fill = 'BLACK')) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
### Part c
airline %>%
inner_join(flightsjan,  by=c("IATA_CODE"="AIRLINE")) %>%
group_by(AIRLINE) %>%
mutate(flightnum = n()) %>%
inner_join(top_n(count(flightsjan, AIRLINE),14),by=c("IATA_CODE"="AIRLINE")) %>%
#arrange(desc(n)) %>%
mutate(distance =  ifelse(DISTANCE > 750, "Distance above 750", "Distance below 750")) %>%
ggplot(aes(fct_reorder(IATA_CODE, flightnum, .desc=TRUE),
TAXI_OUT,
fill=ALLIANCE)) +
geom_boxplot(varwidth = TRUE) +
facet_grid(.~distance) +
scale_x_discrete(labels=(top_n(count(flightsjan, AIRLINE),10))) +
theme_bw() +
scale_fill_manual(values=c("#339933","red","#7300e6","white")) +
xlab('Airline (ordered by total number of flights)') +
ylab("Taxi time (variable: TAXI_OUT)") +
theme(panel.border = element_blank()) +
theme(legend.position="none") +
labs(color='distance > 750')
## Problem 1
### Part a
airline %>%
inner_join(flightsjan,  by=c("IATA_CODE"="AIRLINE")) %>%
group_by(AIRLINE) %>%
mutate(flightnum = n()) %>%
inner_join(top_n(count(flightsjan, AIRLINE),10),by=c("IATA_CODE"="AIRLINE")) %>%
#arrange(desc(n)) %>%
mutate(distance =  ifelse(DISTANCE > 750, TRUE, FALSE)) %>%
ggplot(aes(fct_reorder(IATA_CODE, flightnum, .desc=TRUE),
TAXI_OUT,
color=distance,
fill=ALLIANCE)) +
geom_boxplot(varwidth = TRUE) +
scale_x_discrete(labels=(top_n(count(flightsjan, AIRLINE),10))) +
scale_fill_manual(values=c("#339933","red","#7300e6","white")) +
theme_bw() +
xlab('Airline (ordered by total number of flights)') +
ylab("Taxi time (variable: TAXI_OUT)") +
theme(panel.border = element_blank()) +
labs(color='distance > 750') +
labs(fill='alliance')
### Part c
airline %>%
inner_join(flightsjan,  by=c("IATA_CODE"="AIRLINE")) %>%
group_by(AIRLINE) %>%
mutate(flightnum = n()) %>%
inner_join(top_n(count(flightsjan, AIRLINE),14),by=c("IATA_CODE"="AIRLINE")) %>%
#arrange(desc(n)) %>%
mutate(distance =  ifelse(DISTANCE > 750, "Distance above 750", "Distance below 750")) %>%
ggplot(aes(fct_reorder(IATA_CODE, flightnum, .desc=TRUE),
TAXI_OUT,
fill=ALLIANCE)) +
geom_boxplot(varwidth = TRUE) +
facet_grid(.~distance) +
scale_x_discrete(labels=(top_n(count(flightsjan, AIRLINE),10))) +
theme_bw() +
scale_fill_manual(values=c("#339933","red","#7300e6","white")) +
xlab('Airline (ordered by total number of flights)') +
ylab("Taxi time (variable: TAXI_OUT)") +
theme(panel.border = element_blank()) +
theme(legend.position="none") +
labs(color='distance > 750')
#young people
emnlp14age %>%
filter(weight < 0) %>%
mutate(weight = abs(weight)) %>%
arrange(desc(weight)) %>%
top_n(100)  %>%
wordcloud2(size=0.2)
emnlp14age %>%
filter(weight >0) %>%
arrange(desc(weight)) %>%
slice(0:150) %>%
wordcloud2(size=0.4)
emnlp14age %>%
filter(weight < 0) %>%
mutate(weight = abs(weight)) %>%
arrange(desc(weight)) %>%
slice(100)  %>%
wordcloud2(size=0.2)
emnlp14age %>%
filter(weight < 0) %>%
mutate(weight = abs(weight)) %>%
arrange(desc(weight)) %>%
slice(0:100)  %>%
wordcloud2(size=0.2)
